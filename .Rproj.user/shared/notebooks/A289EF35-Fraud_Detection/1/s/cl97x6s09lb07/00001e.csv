"0","# stack using glm"
"0","stackControl <- trainControl(method=""cv"", number=10, savePredictions=TRUE, classProbs=TRUE, summaryFunction = twoClassSummary)"
"0","set.seed(7)"
"0","stack.glm <- caretStack(models, method=""rf"", metric=""Accuracy"", trControl=stackControl)"
"0","print(stack.glm)"
"1","A rf ensemble of 2 base models: nnet, knn, regLogistic, rf, svmRadial"
"1","

Ensemble results:
"
"1","Random Forest"
"1"," "
"1","

"
"1","3076"
"1"," samples"
"1","
"
"1","   5"
"1"," predictor"
"1","
"
"1","   2"
"1"," "
"1","classes:"
"1"," "
"1","'No', 'Yes'"
"1"," "
"1","
"
"1","
"
"1","No pre-processing
"
"1","Resampling:"
"1"," "
"1","Cross-Validated (10 fold)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","2769, 2769, 2767, 2769, 2768, 2769, ..."
"1"," "
"1","
"
"1","Resampling results"
"1"," across tuning parameters"
"1",":

"
"1","  mtry"
"1","  ROC      "
"1","  Sens     "
"1","  Spec     "
"1","
"
"1","  2   "
"1","  0.9911304"
"1","  0.9855672"
"1","  0.9413131"
"1","
"
"1","  3   "
"1","  0.9910543"
"1","  0.9844265"
"1","  0.9367677"
"1","
"
"1","  5   "
"1","  0.9909783"
"1","  0.9840463"
"1","  0.9367677"
"1","
"
"1","
"
"1","ROC was used to select the optimal model using the largest value.
"
"1","The final value used for the model was mtry = 2."
"1","
"
"0","acc_ensemble1 <- predict(stack.glm, newdata=testing)"
"0","testing$class <- as.factor(testing$class)"
"0","acc_ensemble1 <- as.factor(acc_ensemble1)"
"0","confusionMatrix(testing$class,acc_ensemble1)"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","  No"
"1"," Yes"
"1","
       No "
"1","   0"
"1"," 658"
"1","
       Yes"
"1"," 104"
"1","   7"
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.0091          "
"1","
"
"1","                 95% CI :"
"1"," (0.0037, 0.0187)"
"1","
"
"1","    No Information Rate :"
"1"," 0.8648          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," -0.3047         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," <2e-16          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.000000        "
"1","
"
"1","            Specificity :"
"1"," 0.010526        "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.000000        "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.063063        "
"1","
"
"1","             Prevalence :"
"1"," 0.135241        "
"1","
"
"1","         Detection Rate :"
"1"," 0.000000        "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.855657        "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.005263        "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," No              "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","str(acc_ensemble1)"
"1"," Factor w/ 2 levels ""No"",""Yes"": "
"1","1 2 1 1 2 2 2 2 2 2"
"1"," ..."
"1","
"
"0","str(testing$class)"
"1"," Factor w/ 2 levels ""No"",""Yes"": "
"1","2 1 2 2 1 1 1 1 1 1"
"1"," ..."
"1","
"
